<html>

<head>
    <title>Capillaries blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        body {
            border-top: 4px solid #666;
        }

        h1 {
            font-weight: bold;
            float: left;
        }

        h2 {
            border-bottom: 1px solid #ccc;
            padding-bottom: .2em;
        }

        div.footer {
            border-top: 1px solid #ccc;
            padding: 1em 0 .5em;
            margin-top: 3em;
        }

        img.logo {
            margin-right: 1em;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-12">
              <h4>Calculate probabilities of the number of uniformely distributed items ending up in a bucket</p>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
                <pre class="python"
                    style="font-family:monospace;"><ol><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff7700;font-weight:bold;">def</span> p<span style="color: black;">&#40;</span>items_in_bucket<span style="color: #66cc66;">,</span> cur_items<span style="color: #66cc66;">,</span> m<span style="color: black;">&#41;</span>:</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff7700;font-weight:bold;">if</span> items_in_bucket <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #ff7700;font-weight:bold;">in</span> m:</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        m<span style="color: black;">&#91;</span>items_in_bucket<span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span></div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff7700;font-weight:bold;">if</span> cur_items <span style="color: #ff7700;font-weight:bold;">in</span> m<span style="color: black;">&#91;</span>items_in_bucket<span style="color: black;">&#93;</span>:</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #ff7700;font-weight:bold;">return</span> m<span style="color: black;">&#91;</span>items_in_bucket<span style="color: black;">&#93;</span><span style="color: black;">&#91;</span>cur_items<span style="color: black;">&#93;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff7700;font-weight:bold;">if</span> items_in_bucket <span style="color: #66cc66;">==</span> <span style="color: #ff4500;">0</span>:</div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #808080; font-style: italic;"># Out of all cur_items, none ended up in the bucket</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        m<span style="color: black;">&#91;</span>items_in_bucket<span style="color: black;">&#93;</span><span style="color: black;">&#91;</span>cur_items<span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> <span style="color: #008000;">pow</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>-<span style="color: #ff4500;">1</span>/buckets<span style="color: #66cc66;">,</span>cur_items<span style="color: black;">&#41;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff7700;font-weight:bold;">elif</span> items_in_bucket <span style="color: #66cc66;">==</span> cur_items:</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #808080; font-style: italic;"># Out of all cur_items, all ended up in the bucket</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        m<span style="color: black;">&#91;</span>items_in_bucket<span style="color: black;">&#93;</span><span style="color: black;">&#91;</span>cur_items<span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> <span style="color: #008000;">pow</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>/buckets<span style="color: #66cc66;">,</span> cur_items<span style="color: black;">&#41;</span></div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff7700;font-weight:bold;">else</span>:</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #808080; font-style: italic;"># P(already have enough items in this bucket)*P(item will hit another bucket) +</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #808080; font-style: italic;"># P(missing only one item in this bucket)*P(item will hit this bucket)</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        m<span style="color: black;">&#91;</span>items_in_bucket<span style="color: black;">&#93;</span><span style="color: black;">&#91;</span>cur_items<span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> \</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">            p<span style="color: black;">&#40;</span>items_in_bucket<span style="color: #66cc66;">,</span> cur_items-<span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> m<span style="color: black;">&#41;</span>*<span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>-<span style="color: #ff4500;">1</span>/buckets<span style="color: black;">&#41;</span> + \</div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">            p<span style="color: black;">&#40;</span>items_in_bucket-<span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> cur_items-<span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> m<span style="color: black;">&#41;</span>*<span style="color: #ff4500;">1</span>/buckets</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff7700;font-weight:bold;">return</span> m<span style="color: black;">&#91;</span>items_in_bucket<span style="color: black;">&#93;</span><span style="color: black;">&#91;</span>cur_items<span style="color: black;">&#93;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">items <span style="color: #66cc66;">=</span> <span style="color: #ff4500;">996</span></div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">bucket_total_colors <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff4500;">100</span>:<span style="color: #483d8b;">&quot;<span style="color: #000099; font-weight: bold;">\0</span>33[92m&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #808080; font-style: italic;"># green</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff4500;">1000</span>:<span style="color: #483d8b;">&quot;<span style="color: #000099; font-weight: bold;">\0</span>33[91m&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #808080; font-style: italic;"># red</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff4500;">10000</span>:<span style="color: #483d8b;">&quot;<span style="color: #000099; font-weight: bold;">\0</span>33[94m&quot;</span><span style="color: black;">&#125;</span> <span style="color: #808080; font-style: italic;"># blue</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff7700;font-weight:bold;">for</span> buckets <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: black;">&#91;</span><span style="color: #ff4500;">100</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">1000</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">10000</span><span style="color: black;">&#93;</span>:</div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>bucket_total_colors<span style="color: black;">&#91;</span>buckets<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>f<span style="color: #483d8b;">&quot;{buckets} buckets, {items} items (Poisson λ={items/buckets:0.4})<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    memo <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">    <span style="color: #ff7700;font-weight:bold;">for</span> i <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">20</span><span style="color: black;">&#41;</span>:</div></li><li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        prob <span style="color: #66cc66;">=</span> p<span style="color: black;">&#40;</span>i<span style="color: #66cc66;">,</span>items<span style="color: #66cc66;">,</span>memo<span style="color: black;">&#41;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">        <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>f<span style="color: #483d8b;">&quot;{i}-item buckets: {prob*buckets:.3f}, P={prob:.7f}, {prob*100:.5f}%&quot;</span><span style="color: black;">&#41;</span></div></li><li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;<span style="color: #000099; font-weight: bold;">\0</span>33[0m&quot;</span><span style="color: black;">&#41;</span></div></li></ol></pre>

            </div>
        </div>

        <div class=" footer">
            <p>&copy;
                <script type="text/javascript">document.write("2022-" + new Date().getFullYear());</script>
                Capillaries.io
            </p>
        </div>

    </div>
</body>
</html>