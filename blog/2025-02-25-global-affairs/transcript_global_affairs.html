<html><head><style>
html{font-family:sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}body{margin:0}h1{margin:.67em 0;font-size:2em}pre{font-family:monospace,serif;font-size:1em}pre{white-space:pre-wrap}table{border-collapse:collapse;border-spacing:0}@media print{*{color:#000!important;text-shadow:none!important;background:transparent!important;box-shadow:none!important}pre{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr{page-break-inside:avoid}@page{margin:2cm .5cm}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}.table td,.table th{background-color:#fff!important}.table{border-collapse:collapse!important}}*,*:before,*:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html{font-size:62.5%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;line-height:1.428571429;color:#333;background-color:#fff}p{margin:0 0 10px}.text-right{text-align:right}h1,h2,h3{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:500;line-height:1.1}h1,h2,h3{margin-top:20px;margin-bottom:10px}h1{font-size:36px}h2{font-size:30px}h3{font-size:24px}pre{font-family:Monaco,Menlo,Consolas,"Courier New",monospace}pre{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.428571429;color:#333;word-break:break-all;word-wrap:break-word;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px}.container{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}.container:before,.container:after{display:table;content:" "}.container:after{clear:both}.container:before,.container:after{display:table;content:" "}.container:after{clear:both}.row{margin-right:-15px;margin-left:-15px}.row:before,.row:after{display:table;content:" "}.row:after{clear:both}.row:before,.row:after{display:table;content:" "}.row:after{clear:both}@media(min-width:768px){.container{max-width:750px}}@media(min-width:992px){.container{max-width:970px}}@media(min-width:1200px){.container{max-width:1170px}}table{max-width:100%;background-color:transparent}th{text-align:left}.table{width:100%;margin-bottom:20px}.table thead>tr>th,.table tbody>tr>td{padding:8px;line-height:1.428571429;vertical-align:top;border-top:1px solid #ddd}.table thead>tr>th{vertical-align:bottom;border-bottom:2px solid #ddd}.table thead:first-child tr:first-child th{border-top:0}.table-striped>tbody>tr:nth-child(odd)>td{background-color:#f9f9f9}@-ms-viewport{width:device-width}@media screen and (max-width:400px){@-ms-viewport{width:320px}}</style></head><body>
<div class="container">
<div class=row><h1>global_affairs_quicktest_local_fs_one script and data</h1></div>
<div class="row">
<h2>Input files</h2>
<h3>Global Affairs projects financials</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">project_id</th><th class="text-right">partner_id</th><th class="text-right">amt</th><th class="text-right">start_date</th><th class="text-right">end_date</th><th class="text-right">country_amt_json</th><th class="text-right">sector_amt_json</th></thead><tbody>
<tr><td>p012277001</td><td>29979</td><td>1209600000.0</td><td>20231214</td><td>20251231</td><td>{"R-SOUTHSAHARA": 846720000.0, "R-SOUTHAMERICA": 36288000.0, "R-MIDDLEEAST": 84672000.0, "R-ASIA": 2 ... total length 111</td><td>{"12262": 362880000.0, "12263": 217728000.0, "13040": 628992000.0}</td></tr>
<tr><td>p010807001</td><td>29578</td><td>1000000000.0</td><td>20220331</td><td>20470331</td><td>{"IN": 210000000.0, "PH": 210000000.0, "ID": 210000000.0, "ZA": 210000000.0, "DO": 80000000.0, "MK": ... total length 112</td><td>{"23110": 100000000.0, "23210": 900000000.0}</td></tr>
<tr><td>p005247001</td><td>29979</td><td>930400000.0</td><td>20201216</td><td>20221231</td><td>{"R-SOUTHSAHARA": 604760000.0, "R-SOUTHAMERICA": 37216000.0, "R-MIDDLEEAST": 74432000.0, "R-CENTRALA ... total length 140</td><td>{"12262": 279120000.0, "12263": 158168000.0, "13040": 493112000.0}</td></tr>
<tr><td>d003827001</td><td>29979</td><td>785000000.0</td><td>20170731</td><td>20201231</td><td>{"R-AFRICA": 266900000.0, "R-AMERICA": 259050000.0, "R-ASIA": 259050000.0}</td><td>{"12262": 235500000.0, "12263": 133450000.0, "13040": 416050000.0}</td></tr>
<tr><td>p012183001</td><td>29636</td><td>500000000.0</td><td>20240308</td><td>20470331</td><td>{"R-WESTINDIES": 50000000.0, "R-NORTHCENTRALAMERICA": 150000000.0, "R-SOUTHAMERICA": 300000000.0}</td><td>{"21012": 25000000.0, "23183": 50000000.0, "23210": 70000000.0, "23230": 125000000.0, "23240": 10000 ... total length 229</td></tr>
<tr><td>d002243001</td><td>29981</td><td>500000000.0</td><td>20150917</td><td>20211231</td><td>{"R-AFRICA": 359000000.0, "R-AMERICA": 28000000.0, "R-ASIA": 113000000.0}</td><td>{"12250": 500000000.0}</td></tr>
<tr><td>d000514001</td><td>29979</td><td>450000000.01</td><td>20150327</td><td>20170331</td><td>{"R-AFRICA": 283500000.01, "R-AMERICA": 36000000.0, "R-ASIA": 103500000.0, "R-EUROPE": 27000000.0}</td><td>{"12262": 144000000.0, "12263": 81000000.0, "13040": 225000000.0}</td></tr>
<tr><td>m013354001</td><td>29979</td><td>450000000.0</td><td>20111209</td><td>20141231</td><td>{"R-AFRICA": 225000000.0, "R-AMERICA": 49500000.0, "R-ASIA": 126000000.0, "R-EUROPE": 49500000.0}</td><td>{"12262": 99000000.0, "12263": 72000000.0, "13040": 279000000.0}</td></tr>
<tr><td>m012761001</td><td>29979</td><td>450000000.0</td><td>20080319</td><td>20110331</td><td>{"R-AFRICA": 283500000.0, "R-AMERICA": 31500000.0, "R-ASIA": 103500000.0, "R-EUROPE": 31500000.0}</td><td>{"12262": 99000000.0, "12263": 72000000.0, "13040": 279000000.0}</td></tr>
<tr><td>p006992001</td><td>29981</td><td>400000000.0</td><td>20210330</td><td>20260331</td><td>{"R-AFRICA": 276000000.0, "R-AMERICA": 4000000.0, "R-ASIA": 120000000.0}</td><td>{"12250": 336000000.0, "12350": 20000000.0, "13030": 24000000.0, "13040": 20000000.0}</td></tr>
</tbody></table>
<p>Total 19 rows</p>
</div>
<div class="row">
<h2>1_read_project_financials</h2>
<h3>Script node 1_read_project_financials:</h3>
<pre id="json">{
  "1_read_project_financials": {
    "type": "file_table",
    "desc": "Read file harvested_project_financials_*.csv to table",
    "r": {
      "urls": [
        "{dir_in}/{harvested_project_financials_file}"
      ],
      "csv": {
        "hdr_line_idx": 0,
        "first_data_line_idx": 1,
        "separator": ","
      },
      "columns": {
        "project_id": {
          "col_type": "string",
          "csv": {
            "col_hdr": "project_id"
          }
        },
        "partner_id": {
          "col_type": "int",
          "csv": {
            "col_hdr": "partner_id",
            "col_format": "%d"
          }
        },
        "amt": {
          "col_type": "float",
          "csv": {
            "col_hdr": "amt",
            "col_format": "%f"
          }
        },
        "start_date": {
          "col_type": "int",
          "csv": {
            "col_hdr": "start_date",
            "col_format": "%d"
          }
        },
        "end_date": {
          "col_type": "int",
          "csv": {
            "col_hdr": "end_date",
            "col_format": "%d"
          }
        },
        "country_amt_json": {
          "col_type": "string",
          "csv": {
            "col_hdr": "country_amt_json"
          }
        },
        "sector_amt_json": {
          "col_type": "string",
          "csv": {
            "col_hdr": "sector_amt_json"
          }
        }
      }
    },
    "w": {
      "name": "project_financials",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "partner_id": {
          "expression": "r.partner_id",
          "type": "int"
        },
        "amt": {
          "expression": "r.amt",
          "type": "float"
        },
        "start_date": {
          "expression": "r.start_date",
          "type": "int"
        },
        "end_date": {
          "expression": "r.end_date",
          "type": "int"
        },
        "country_amt_json": {
          "expression": "r.country_amt_json",
          "type": "string"
        },
        "sector_amt_json": {
          "expression": "r.sector_amt_json",
          "type": "string"
        }
      }
    }
  }
}</pre>
<h3>Script node 1_read_project_financials produces Cassandra table project_financials:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">amt</th><th class="text-right">batch_idx</th><th class="text-right">country_amt_json</th><th class="text-right">end_date</th><th class="text-right">partner_id</th><th class="text-right">project_id</th><th class="text-right">sector_amt_json</th><th class="text-right">start_date</th></thead><tbody>
<tr><td>8911412958647610754</td><td>275000000</td><td>0</td><td>{"R-AFRICA": 55000000.0, "R-AMERICA": 82500000.0, "R-ASIA": 137500000.0}</td><td>20430320</td><td>29578</td><td>p006167001</td><td>{"23210": 225500000.0, "31220": 49500000.0}</td><td>20200329</td></tr>
<tr><td>1286137648438935688</td><td>302400000</td><td>0</td><td>{"R-AFRICA": 302400000.0}</td><td>20100517</td><td>29663</td><td>m012672001</td><td>{"11420": 21168000.0, "14021": 30240000.0, "14022": 30240000.0, "15110": 60480000.0, "21020": 604800 ... total length 147</td><td>20071101</td></tr>
<tr><td>370061222550674975</td><td>785000000</td><td>0</td><td>{"R-AFRICA": 266900000.0, "R-AMERICA": 259050000.0, "R-ASIA": 259050000.0}</td><td>20201231</td><td>29979</td><td>d003827001</td><td>{"12262": 235500000.0, "12263": 133450000.0, "13040": 416050000.0}</td><td>20170731</td></tr>
<tr><td>4976470387084332825</td><td>400000000</td><td>0</td><td>{"R-AFRICA": 276000000.0, "R-AMERICA": 4000000.0, "R-ASIA": 120000000.0}</td><td>20260331</td><td>29981</td><td>p006992001</td><td>{"12250": 336000000.0, "12350": 20000000.0, "13030": 24000000.0, "13040": 20000000.0}</td><td>20210330</td></tr>
<tr><td>3066850684629448543</td><td>450000000</td><td>0</td><td>{"R-AFRICA": 225000000.0, "R-AMERICA": 49500000.0, "R-ASIA": 126000000.0, "R-EUROPE": 49500000.0}</td><td>20141231</td><td>29979</td><td>m013354001</td><td>{"12262": 99000000.0, "12263": 72000000.0, "13040": 279000000.0}</td><td>20111209</td></tr>
<tr><td>7947324735076598373</td><td>350000000</td><td>0</td><td>{"R-ASIA": 315000000.0, "R-OCEANIA": 35000000.0}</td><td>20421231</td><td>29588</td><td>p012801001</td><td>{"14021": 28000000.0, "23210": 150500000.0, "23630": 38500000.0, "23642": 35000000.0, "24030": 28000 ... total length 169</td><td>20240312</td></tr>
<tr><td>141290931591420991</td><td>500000000</td><td>0</td><td>{"R-AFRICA": 359000000.0, "R-AMERICA": 28000000.0, "R-ASIA": 113000000.0}</td><td>20211231</td><td>29981</td><td>d002243001</td><td>{"12250": 500000000.0}</td><td>20150917</td></tr>
<tr><td>2652268069297647365</td><td>300000000</td><td>0</td><td>{"R-SOUTHSAHARA": 75000000.0, "R-AFRICA": 75000000.0, "R-AMERICA": 75000000.0, "R-ASIA": 75000000.0}</td><td>20350630</td><td>30488</td><td>p008157001</td><td>{"15170": 300000000.0}</td><td>20190829</td></tr>
<tr><td>4405365935203015753</td><td>930400000</td><td>0</td><td>{"R-SOUTHSAHARA": 604760000.0, "R-SOUTHAMERICA": 37216000.0, "R-MIDDLEEAST": 74432000.0, "R-CENTRALA ... total length 140</td><td>20221231</td><td>29979</td><td>p005247001</td><td>{"12262": 279120000.0, "12263": 158168000.0, "13040": 493112000.0}</td><td>20201216</td></tr>
<tr><td>2308675051745905581</td><td>450000000</td><td>0</td><td>{"R-AFRICA": 283500000.0, "R-AMERICA": 31500000.0, "R-ASIA": 103500000.0, "R-EUROPE": 31500000.0}</td><td>20110331</td><td>29979</td><td>m012761001</td><td>{"12262": 99000000.0, "12263": 72000000.0, "13040": 279000000.0}</td><td>20080319</td></tr>
</tbody></table>
<p>Total 19 rows</p>
</div>
<div class="row">
<h2>2_calc_quarterly_budget</h2>
<h3>Script node 2_calc_quarterly_budget:</h3>
<pre id="json">{
  "2_calc_quarterly_budget": {
    "type": "table_custom_tfm_table",
    "custom_proc_type": "py_calc",
    "desc": "Calculate quarterly project budget for countries and sectors",
    "start_policy": "{manual_if_multi}",
    "r": {
      "table": "project_financials",
      "expected_batches_total": 10
    },
    "p": {
      "python_code_urls": [
        "{dir_py}/calc_quarterly_budget.py"
      ],
      "calculated_fields": {
        "country_budget_json": {
          "expression": "map_to_quarterly_budget_json(r.start_date, r.end_date, r.country_amt_json)",
          "type": "string"
        },
        "sector_budget_json": {
          "expression": "map_to_quarterly_budget_json(r.start_date, r.end_date, r.sector_amt_json)",
          "type": "string"
        },
        "partner_budget_json": {
          "expression": "amt_to_quarterly_budget_json(r.start_date, r.end_date, r.amt)",
          "type": "string"
        }
      }
    },
    "w": {
      "name": "quarterly_project_bdgt",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "partner_id": {
          "expression": "r.partner_id",
          "type": "int"
        },
        "country_budget_json": {
          "expression": "p.country_budget_json",
          "type": "string"
        },
        "sector_budget_json": {
          "expression": "p.sector_budget_json",
          "type": "string"
        },
        "partner_budget_json": {
          "expression": "p.partner_budget_json",
          "type": "string"
        }
      }
    }
  }
}</pre>
<h3>Script node 2_calc_quarterly_budget produces Cassandra table quarterly_project_bdgt:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">batch_idx</th><th class="text-right">country_budget_json</th><th class="text-right">partner_budget_json</th><th class="text-right">partner_id</th><th class="text-right">project_id</th><th class="text-right">sector_budget_json</th></thead><tbody>
<tr><td>1110774427483232336</td><td>4</td><td>{"R-AFRICA": {"2007-Q4": 19856189.451022606, "2008-Q1": 29621528.525296018, "2008-Q2": 29621528.5252 ... total length 354</td><td>{"2007-Q4": 19856189.451022606, "2008-Q1": 29621528.525296018, "2008-Q2": 29621528.525296018, "2008- ... total length 340</td><td>29663</td><td>m012672001</td><td>{"11420": {"2007-Q4": 1389933.2615715822, "2008-Q1": 2073506.9967707212, "2008-Q2": 2073506.99677072 ... total length 2429</td></tr>
<tr><td>1143586065972677594</td><td>0</td><td>{"IN": {"2022-Q1": 22996.057818659658, "2022-Q2": 2092641.2614980289, "2022-Q3": 2115637.3193166885, ... total length 18632</td><td>{"2022-Q1": 109505.03723171266, "2022-Q2": 9964958.388085851, "2022-Q3": 10074463.425317565, "2022-Q ... total length 3062</td><td>29578</td><td>p010807001</td><td>{"23110": {"2022-Q1": 10950.503723171267, "2022-Q2": 996495.8388085853, "2022-Q3": 1007446.342531756 ... total length 6063</td></tr>
<tr><td>8821477199105233802</td><td>8</td><td>{"R-AFRICA": {"2023-Q1": 11405.109489051094, "2023-Q2": 518932.4817518248, "2023-Q3": 524635.0364963 ... total length 11700</td><td>{"2023-Q1": 57025.54744525548, "2023-Q2": 2594662.408759124, "2023-Q3": 2623175.182481752, "2023-Q4" ... total length 2928</td><td>33915</td><td>p010532001</td><td>{"14021": {"2023-Q1": 5702.554744525547, "2023-Q2": 259466.2408759124, "2023-Q3": 262317.51824817515 ... total length 11924</td></tr>
<tr><td>5406827533858392767</td><td>3</td><td>{"R-AFRICA": {"2020-Q1": 19661.582459485224, "2020-Q2": 596401.3346043852, "2020-Q3": 602955.1954242 ... total length 8472</td><td>{"2020-Q1": 98307.91229742613, "2020-Q2": 2982006.6730219256, "2020-Q3": 3014775.9771210677, "2020-Q ... total length 2865</td><td>29578</td><td>p006167001</td><td>{"23210": {"2020-Q1": 80612.48808388942, "2020-Q2": 2445245.471877979, "2020-Q3": 2472116.3012392754 ... total length 5649</td></tr>
<tr><td>3649002051905147572</td><td>8</td><td>{"R-WESTINDIES": {"2012-Q1": 10949.304719150334, "2012-Q2": 498193.3647213402, "2012-Q3": 503668.017 ... total length 9306</td><td>{"2012-Q1": 54746.52359794153, "2012-Q2": 2490966.8237063396, "2012-Q3": 2518340.0855053104, "2012-Q ... total length 3130</td><td>29636</td><td>m013705001</td><td>{"14015": {"2012-Q1": 5474.652359575167, "2012-Q2": 249096.6823606701, "2012-Q3": 251834.00854045767 ... total length 27991</td></tr>
<tr><td>6799573953047713268</td><td>1</td><td>{"R-AFRICA": {"2008-Q1": 3326263.5379061373, "2008-Q2": 23283844.765342962, "2008-Q3": 23539711.1913 ... total length 1626</td><td>{"2008-Q1": 5279783.393501805, "2008-Q2": 36958483.75451264, "2008-Q3": 37364620.93862816, "2008-Q4" ... total length 390</td><td>29979</td><td>m012761001</td><td>{"12262": {"2008-Q1": 1161552.346570397, "2008-Q2": 8130866.425992779, "2008-Q3": 8220216.606498195, ... total length 1206</td></tr>
<tr><td>4345966479589710988</td><td>1</td><td>{"R-ASIA": {"2024-Q1": 917164.0704614937, "2024-Q2": 4173096.5205997964, "2024-Q3": 4218954.72412287 ... total length 4700</td><td>{"2024-Q1": 1019071.1894016596, "2024-Q2": 4636773.911777551, "2024-Q3": 4687727.471247634, "2024-Q4 ... total length 2281</td><td>29588</td><td>p012801001</td><td>{"14021": {"2024-Q1": 81525.69515213277, "2024-Q2": 370941.9129422041, "2024-Q3": 375018.1976998107, ... total length 18663</td></tr>
<tr><td>7249363290507467685</td><td>5</td><td>{"R-WESTINDIES": {"2024-Q1": 142450.14245014245, "2024-Q2": 540123.4567901234, "2024-Q3": 546058.879 ... total length 8602</td><td>{"2024-Q1": 1424501.4245014247, "2024-Q2": 5401234.567901235, "2024-Q3": 5460588.793922127, "2024-Q4 ... total length 2791</td><td>29636</td><td>p012183001</td><td>{"21012": {"2024-Q1": 71225.07122507122, "2024-Q2": 270061.7283950617, "2024-Q3": 273029.43969610636 ... total length 31222</td></tr>
<tr><td>5594565194764002053</td><td>1</td><td>{"R-SOUTHSAHARA": {"2019-Q3": 427830.59636992216, "2019-Q4": 1192739.8444252377, "2020-Q1": 1179775. ... total length 7948</td><td>{"2019-Q3": 1711322.3854796886, "2019-Q4": 4770959.377700951, "2020-Q1": 4719101.123595505, "2020-Q2 ... total length 1909</td><td>30488</td><td>p008157001</td><td>{"15170": {"2019-Q3": 1711322.3854796886, "2019-Q4": 4770959.377700951, "2020-Q1": 4719101.123595505 ... total length 1920</td></tr>
<tr><td>2585466656026207353</td><td>8</td><td>{"R-SOUTHSAHARA": {"2020-Q4": 12970723.860589812, "2021-Q1": 72960321.71581769, "2021-Q2": 73770991. ... total length 1446</td><td>{"2020-Q4": 19954959.78552279, "2021-Q1": 112246648.79356569, "2021-Q2": 113493833.78016086, "2021-Q ... total length 278</td><td>29979</td><td>p005247001</td><td>{"12262": {"2020-Q4": 5986487.935656836, "2021-Q1": 33673994.638069704, "2021-Q2": 34048150.13404825 ... total length 850</td></tr>
</tbody></table>
<p>Total 19 rows</p>
</div>
<div class="row">
<h2>3_tag_countries</h2>
<h3>Script node 3_tag_countries:</h3>
<pre id="json">{
  "3_tag_countries": {
    "type": "table_custom_tfm_table",
    "custom_proc_type": "tag_and_denormalize",
    "desc": "Tag by country",
    "start_policy": "{manual_if_multi}",
    "r": {
      "table": "quarterly_project_bdgt",
      "expected_batches_total": 10
    },
    "p": {
      "tag_field_name": "country_tag",
      "tag_criteria_url": "{dir_cfg}/tag_criteria_country.json"
    },
    "w": {
      "name": "quarterly_project_bdgt_tggd_by_country",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "country": {
          "expression": "p.country_tag",
          "type": "string"
        },
        "country_budget_json": {
          "expression": "r.country_budget_json",
          "type": "string"
        }
      }
    }
  }
}</pre>
<h3>Script node 3_tag_countries produces Cassandra table quarterly_project_bdgt_tggd_by_country:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">batch_idx</th><th class="text-right">country</th><th class="text-right">country_budget_json</th><th class="text-right">project_id</th></thead><tbody>
<tr><td>1248413069363240154</td><td>7</td><td>R-EUROPE</td><td>{"R-AFRICA": {"2023-Q1": 11405.109489051094, "2023-Q2": 518932.4817518248, "2023-Q3": 524635.0364963 ... total length 11700</td><td>p010532001</td></tr>
<tr><td>161814038278348408</td><td>3</td><td>R-ASIA</td><td>{"R-AFRICA": {"2019-Q2": 2959048.8771466315, "2019-Q3": 5671510.347864377, "2019-Q4": 5671510.347864 ... total length 1590</td><td>p005253001</td></tr>
<tr><td>8958368832873835307</td><td>8</td><td>R-SOUTHSAHARA</td><td>{"R-SOUTHSAHARA": {"2023-Q4": 20348411.21495327, "2024-Q1": 102872523.36448598, "2024-Q2": 102872523 ... total length 1158</td><td>p012277001</td></tr>
<tr><td>2403001335442646416</td><td>7</td><td>R-AFRICA</td><td>{"R-AFRICA": {"2011-Q4": 4624664.879356569, "2012-Q1": 18297587.131367292, "2012-Q2": 18297587.13136 ... total length 1626</td><td>m013354001</td></tr>
<tr><td>7523888077805831152</td><td>0</td><td>IN</td><td>{"IN": {"2022-Q1": 22996.057818659658, "2022-Q2": 2092641.2614980289, "2022-Q3": 2115637.3193166885, ... total length 18632</td><td>p010807001</td></tr>
<tr><td>615504173205791914</td><td>5</td><td>R-AMERICA</td><td>{"R-AFRICA": {"2020-Q1": 19661.582459485224, "2020-Q2": 596401.3346043852, "2020-Q3": 602955.1954242 ... total length 8472</td><td>p006167001</td></tr>
<tr><td>1610119117934216491</td><td>5</td><td>R-NORTHCENTRALAMERICA</td><td>{"R-WESTINDIES": {"2012-Q1": 10949.304719150334, "2012-Q2": 498193.3647213402, "2012-Q3": 503668.017 ... total length 9306</td><td>m013705001</td></tr>
<tr><td>6757651577025308730</td><td>7</td><td>R-EUROPE</td><td>{"R-AFRICA": {"2011-Q4": 4624664.879356569, "2012-Q1": 18297587.131367292, "2012-Q2": 18297587.13136 ... total length 1626</td><td>m013354001</td></tr>
<tr><td>6861869827705868336</td><td>7</td><td>R-EUROPE</td><td>{"R-AFRICA": {"2015-Q1": 1925951.0870244564, "2015-Q2": 35052309.783845104, "2015-Q3": 35437500.0012 ... total length 1040</td><td>d000514001</td></tr>
<tr><td>4628965319831263401</td><td>0</td><td>ID</td><td>{"IN": {"2022-Q1": 22996.057818659658, "2022-Q2": 2092641.2614980289, "2022-Q3": 2115637.3193166885, ... total length 18632</td><td>p010807001</td></tr>
</tbody></table>
<p>Total 63 rows</p>
</div>
<div class="row">
<h2>3_tag_sectors</h2>
<h3>Script node 3_tag_sectors:</h3>
<pre id="json">{
  "3_tag_sectors": {
    "type": "table_custom_tfm_table",
    "custom_proc_type": "tag_and_denormalize",
    "desc": "Tag by sector",
    "start_policy": "{manual_if_multi}",
    "r": {
      "table": "quarterly_project_bdgt",
      "expected_batches_total": 10
    },
    "p": {
      "tag_field_name": "sector_tag",
      "tag_criteria_url": "{dir_cfg}/tag_criteria_sector.json"
    },
    "w": {
      "name": "quarterly_project_bdgt_tggd_by_sector",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "sector": {
          "expression": "int(p.sector_tag)",
          "type": "int"
        },
        "sector_budget_json": {
          "expression": "r.sector_budget_json",
          "type": "string"
        }
      }
    }
  }
}</pre>
<h3>Script node 3_tag_sectors produces Cassandra table quarterly_project_bdgt_tggd_by_sector:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">batch_idx</th><th class="text-right">project_id</th><th class="text-right">sector</th><th class="text-right">sector_budget_json</th></thead><tbody>
<tr><td>6265369124608349645</td><td>0</td><td>p005247001</td><td>13040</td><td>{"12262": {"2020-Q4": 5986487.935656836, "2021-Q1": 33673994.638069704, "2021-Q2": 34048150.13404825 ... total length 850</td></tr>
<tr><td>2209896342624457387</td><td>0</td><td>p005247001</td><td>12262</td><td>{"12262": {"2020-Q4": 5986487.935656836, "2021-Q1": 33673994.638069704, "2021-Q2": 34048150.13404825 ... total length 850</td></tr>
<tr><td>411235998913570795</td><td>3</td><td>p012183001</td><td>41030</td><td>{"21012": {"2024-Q1": 71225.07122507122, "2024-Q2": 270061.7283950617, "2024-Q3": 273029.43969610636 ... total length 31222</td></tr>
<tr><td>1795015652446192040</td><td>5</td><td>m013705001</td><td>23210</td><td>{"14015": {"2012-Q1": 5474.652359575167, "2012-Q2": 249096.6823606701, "2012-Q3": 251834.00854045767 ... total length 27991</td></tr>
<tr><td>2457737869831648243</td><td>5</td><td>m013705001</td><td>14015</td><td>{"14015": {"2012-Q1": 5474.652359575167, "2012-Q2": 249096.6823606701, "2012-Q3": 251834.00854045767 ... total length 27991</td></tr>
<tr><td>5655135333152804570</td><td>1</td><td>m013512001</td><td>14022</td><td>{"14021": {"2011-Q1": 749203.7684955753, "2011-Q2": 1311106.5948672567, "2011-Q3": 1325514.359646017 ... total length 6564</td></tr>
<tr><td>4679381727745154934</td><td>5</td><td>m012761001</td><td>12263</td><td>{"12262": {"2008-Q1": 1161552.346570397, "2008-Q2": 8130866.425992779, "2008-Q3": 8220216.606498195, ... total length 1206</td></tr>
<tr><td>6092413576809087552</td><td>9</td><td>p008157001</td><td>15170</td><td>{"15170": {"2019-Q3": 1711322.3854796886, "2019-Q4": 4770959.377700951, "2020-Q1": 4719101.123595505 ... total length 1920</td></tr>
<tr><td>2219714617461310382</td><td>8</td><td>p012277001</td><td>12262</td><td>{"12262": {"2023-Q4": 8720747.663551401, "2024-Q1": 44088224.29906542, "2024-Q2": 44088224.29906542, ... total length 855</td></tr>
<tr><td>8471173369051697756</td><td>7</td><td>d000514001</td><td>12262</td><td>{"12262": {"2015-Q1": 978260.8695652174, "2015-Q2": 17804347.826086957, "2015-Q3": 18000000.0, "2015 ... total length 766</td></tr>
</tbody></table>
<p>Total 89 rows</p>
</div>
<div class="row">
<h2>4_tag_countries_quarter</h2>
<h3>Script node 4_tag_countries_quarter:</h3>
<pre id="json">{
  "4_tag_countries_quarter": {
    "type": "table_custom_tfm_table",
    "custom_proc_type": "tag_and_denormalize",
    "desc": "Tag by country and quarter",
    "start_policy": "{manual_if_multi}",
    "r": {
      "table": "quarterly_project_bdgt_tggd_by_country",
      "expected_batches_total": 10
    },
    "p": {
      "tag_field_name": "quarter_tag",
      "tag_criteria_url": "{dir_cfg}/tag_criteria_country_quarter.json"
    },
    "w": {
      "name": "quarterly_project_bdgt_tggd_by_country_qtr",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "country": {
          "expression": "r.country",
          "type": "string"
        },
        "quarter": {
          "expression": "p.quarter_tag",
          "type": "string"
        },
        "country_budget_json": {
          "expression": "r.country_budget_json",
          "type": "string"
        }
      }
    }
  }
}</pre>
<h3>Script node 4_tag_countries_quarter produces Cassandra table quarterly_project_bdgt_tggd_by_country_qtr:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">batch_idx</th><th class="text-right">country</th><th class="text-right">country_budget_json</th><th class="text-right">project_id</th><th class="text-right">quarter</th></thead><tbody>
<tr><td>6492953802424297929</td><td>5</td><td>R-ASIA</td><td>{"R-AFRICA": {"2023-Q1": 11405.109489051094, "2023-Q2": 518932.4817518248, "2023-Q3": 524635.0364963 ... total length 11700</td><td>p010532001</td><td>2039-Q2</td></tr>
<tr><td>8369222996845037265</td><td>7</td><td>R-AFRICA</td><td>{"R-SOUTHSAHARA": {"2019-Q3": 427830.59636992216, "2019-Q4": 1192739.8444252377, "2020-Q1": 1179775. ... total length 7948</td><td>p008157001</td><td>2030-Q2</td></tr>
<tr><td>3991428177273871527</td><td>1</td><td>R-AFRICA</td><td>{"R-AFRICA": {"2011-Q4": 4624664.879356569, "2012-Q1": 18297587.131367292, "2012-Q2": 18297587.13136 ... total length 1626</td><td>m013354001</td><td>2013-Q4</td></tr>
<tr><td>7342505052366961352</td><td>0</td><td>R-EUROPE</td><td>{"R-AFRICA": {"2023-Q1": 11405.109489051094, "2023-Q2": 518932.4817518248, "2023-Q3": 524635.0364963 ... total length 11700</td><td>p010532001</td><td>2031-Q2</td></tr>
<tr><td>329413984584647843</td><td>3</td><td>R-SOUTHAMERICA</td><td>{"R-SOUTHSAHARA": {"2023-Q4": 20348411.21495327, "2024-Q1": 102872523.36448598, "2024-Q2": 102872523 ... total length 1158</td><td>p012277001</td><td>2024-Q4</td></tr>
<tr><td>444896247391767300</td><td>0</td><td>R-AFRICA</td><td>{"R-AFRICA": {"2020-Q1": 19661.582459485224, "2020-Q2": 596401.3346043852, "2020-Q3": 602955.1954242 ... total length 8472</td><td>p006167001</td><td>2032-Q4</td></tr>
<tr><td>2266330396245269672</td><td>1</td><td>R-AFRICA</td><td>{"R-AFRICA": {"2011-Q4": 4624664.879356569, "2012-Q1": 18297587.131367292, "2012-Q2": 18297587.13136 ... total length 1626</td><td>m013354001</td><td>2012-Q1</td></tr>
<tr><td>2001117337629165355</td><td>7</td><td>R-AFRICA</td><td>{"R-SOUTHSAHARA": {"2019-Q3": 427830.59636992216, "2019-Q4": 1192739.8444252377, "2020-Q1": 1179775. ... total length 7948</td><td>p008157001</td><td>2034-Q1</td></tr>
<tr><td>424662318704452281</td><td>3</td><td>R-ASIA</td><td>{"R-ASIA": {"2024-Q1": 917164.0704614937, "2024-Q2": 4173096.5205997964, "2024-Q3": 4218954.72412287 ... total length 4700</td><td>p012801001</td><td>2036-Q2</td></tr>
<tr><td>5692577505011649179</td><td>3</td><td>R-ASIA</td><td>{"R-AFRICA": {"2015-Q1": 1925951.0870244564, "2015-Q2": 35052309.783845104, "2015-Q3": 35437500.0012 ... total length 1040</td><td>d000514001</td><td>2015-Q1</td></tr>
</tbody></table>
<p>Total 2815 rows</p>
</div>
<div class="row">
<h2>4_tag_sectors_quarter</h2>
<h3>Script node 4_tag_sectors_quarter:</h3>
<pre id="json">{
  "4_tag_sectors_quarter": {
    "type": "table_custom_tfm_table",
    "custom_proc_type": "tag_and_denormalize",
    "desc": "Tag by sector and quarter",
    "start_policy": "{manual_if_multi}",
    "r": {
      "table": "quarterly_project_bdgt_tggd_by_sector",
      "expected_batches_total": 10
    },
    "p": {
      "tag_field_name": "quarter_tag",
      "tag_criteria_url": "{dir_cfg}/tag_criteria_sector_quarter.json"
    },
    "w": {
      "name": "quarterly_project_bdgt_tggd_by_sector_qtr",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "sector": {
          "expression": "r.sector",
          "type": "int"
        },
        "quarter": {
          "expression": "p.quarter_tag",
          "type": "string"
        },
        "sector_budget_json": {
          "expression": "r.sector_budget_json",
          "type": "string"
        }
      }
    }
  }
}</pre>
<h3>Script node 4_tag_sectors_quarter produces Cassandra table quarterly_project_bdgt_tggd_by_sector_qtr:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">batch_idx</th><th class="text-right">project_id</th><th class="text-right">quarter</th><th class="text-right">sector</th><th class="text-right">sector_budget_json</th></thead><tbody>
<tr><td>3417114361344186478</td><td>1</td><td>p010807001</td><td>2023-Q3</td><td>23210</td><td>{"23110": {"2022-Q1": 10950.503723171267, "2022-Q2": 996495.8388085853, "2022-Q3": 1007446.342531756 ... total length 6063</td></tr>
<tr><td>278214716076955433</td><td>3</td><td>m013512001</td><td>2012-Q1</td><td>22020</td><td>{"14021": {"2011-Q1": 749203.7684955753, "2011-Q2": 1311106.5948672567, "2011-Q3": 1325514.359646017 ... total length 6564</td></tr>
<tr><td>6217006696553929290</td><td>3</td><td>p012183001</td><td>2025-Q4</td><td>23230</td><td>{"21012": {"2024-Q1": 71225.07122507122, "2024-Q2": 270061.7283950617, "2024-Q3": 273029.43969610636 ... total length 31222</td></tr>
<tr><td>6394077211708104292</td><td>8</td><td>p012801001</td><td>2028-Q4</td><td>31320</td><td>{"14021": {"2024-Q1": 81525.69515213277, "2024-Q2": 370941.9129422041, "2024-Q3": 375018.1976998107, ... total length 18663</td></tr>
<tr><td>6295086044700624849</td><td>1</td><td>p010807001</td><td>2036-Q1</td><td>23210</td><td>{"23110": {"2022-Q1": 10950.503723171267, "2022-Q2": 996495.8388085853, "2022-Q3": 1007446.342531756 ... total length 6063</td></tr>
<tr><td>2827034138982770271</td><td>7</td><td>m013705001</td><td>2017-Q4</td><td>41020</td><td>{"14015": {"2012-Q1": 5474.652359575167, "2012-Q2": 249096.6823606701, "2012-Q3": 251834.00854045767 ... total length 27991</td></tr>
<tr><td>3924812568294015995</td><td>2</td><td>p006167001</td><td>2030-Q1</td><td>31220</td><td>{"23210": {"2020-Q1": 80612.48808388942, "2020-Q2": 2445245.471877979, "2020-Q3": 2472116.3012392754 ... total length 5649</td></tr>
<tr><td>7984473861537271468</td><td>9</td><td>p010532001</td><td>2023-Q2</td><td>24010</td><td>{"14021": {"2023-Q1": 5702.554744525547, "2023-Q2": 259466.2408759124, "2023-Q3": 262317.51824817515 ... total length 11924</td></tr>
<tr><td>2278529692064738060</td><td>8</td><td>p012801001</td><td>2031-Q4</td><td>14021</td><td>{"14021": {"2024-Q1": 81525.69515213277, "2024-Q2": 370941.9129422041, "2024-Q3": 375018.1976998107, ... total length 18663</td></tr>
<tr><td>3112752376945673075</td><td>1</td><td>p010532001</td><td>2046-Q1</td><td>23210</td><td>{"14021": {"2023-Q1": 5702.554744525547, "2023-Q2": 259466.2408759124, "2023-Q3": 262317.51824817515 ... total length 11924</td></tr>
</tbody></table>
<p>Total 4100 rows</p>
</div>
<div class="row">
<h2>4_tag_partners_quarter</h2>
<h3>Script node 4_tag_partners_quarter:</h3>
<pre id="json">{
  "4_tag_partners_quarter": {
    "type": "table_custom_tfm_table",
    "custom_proc_type": "tag_and_denormalize",
    "desc": "Tag by partner and quarter",
    "start_policy": "{manual_if_multi}",
    "r": {
      "table": "quarterly_project_bdgt",
      "expected_batches_total": 10
    },
    "p": {
      "tag_field_name": "quarter_tag",
      "tag_criteria_url": "{dir_cfg}/tag_criteria_partner_quarter.json"
    },
    "w": {
      "name": "quarterly_project_bdgt_tggd_by_partner_qtr",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "partner_id": {
          "expression": "r.partner_id",
          "type": "int"
        },
        "quarter": {
          "expression": "p.quarter_tag",
          "type": "string"
        },
        "partner_budget_json": {
          "expression": "r.partner_budget_json",
          "type": "string"
        }
      }
    }
  }
}</pre>
<h3>Script node 4_tag_partners_quarter produces Cassandra table quarterly_project_bdgt_tggd_by_partner_qtr:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">batch_idx</th><th class="text-right">partner_budget_json</th><th class="text-right">partner_id</th><th class="text-right">project_id</th><th class="text-right">quarter</th></thead><tbody>
<tr><td>7342940742954749308</td><td>5</td><td>{"2008-Q1": 5279783.393501805, "2008-Q2": 36958483.75451264, "2008-Q3": 37364620.93862816, "2008-Q4" ... total length 390</td><td>29979</td><td>m012761001</td><td>2008-Q1</td></tr>
<tr><td>3394236084649177899</td><td>3</td><td>{"2024-Q1": 1019071.1894016596, "2024-Q2": 4636773.911777551, "2024-Q3": 4687727.471247634, "2024-Q4 ... total length 2281</td><td>29588</td><td>p012801001</td><td>2031-Q2</td></tr>
<tr><td>5071788641754749770</td><td>5</td><td>{"2012-Q1": 54746.52359794153, "2012-Q2": 2490966.8237063396, "2012-Q3": 2518340.0855053104, "2012-Q ... total length 3130</td><td>29636</td><td>m013705001</td><td>2024-Q2</td></tr>
<tr><td>6626161188484444956</td><td>5</td><td>{"2020-Q1": 98307.91229742613, "2020-Q2": 2982006.6730219256, "2020-Q3": 3014775.9771210677, "2020-Q ... total length 2865</td><td>29578</td><td>p006167001</td><td>2040-Q1</td></tr>
<tr><td>2134130478402844279</td><td>7</td><td>{"2023-Q1": 57025.54744525548, "2023-Q2": 2594662.408759124, "2023-Q3": 2623175.182481752, "2023-Q4" ... total length 2928</td><td>33915</td><td>p010532001</td><td>2031-Q1</td></tr>
<tr><td>1694080718445760647</td><td>5</td><td>{"2012-Q1": 54746.52359794153, "2012-Q2": 2490966.8237063396, "2012-Q3": 2518340.0855053104, "2012-Q ... total length 3130</td><td>29636</td><td>m013705001</td><td>2019-Q2</td></tr>
<tr><td>8401088962749715498</td><td>7</td><td>{"2023-Q1": 57025.54744525548, "2023-Q2": 2594662.408759124, "2023-Q3": 2623175.182481752, "2023-Q4" ... total length 2928</td><td>33915</td><td>p010532001</td><td>2041-Q4</td></tr>
<tr><td>1141318120458157259</td><td>5</td><td>{"2012-Q1": 54746.52359794153, "2012-Q2": 2490966.8237063396, "2012-Q3": 2518340.0855053104, "2012-Q ... total length 3130</td><td>29636</td><td>m013705001</td><td>2034-Q3</td></tr>
<tr><td>2194763728648754650</td><td>1</td><td>{"2015-Q3": 3046127.0670147957, "2015-Q4": 20017406.440382943, "2016-Q1": 19799825.93559617, "2016-Q ... total length 790</td><td>29981</td><td>d002243001</td><td>2021-Q1</td></tr>
<tr><td>8530353620023620803</td><td>5</td><td>{"2020-Q1": 98307.91229742613, "2020-Q2": 2982006.6730219256, "2020-Q3": 3014775.9771210677, "2020-Q ... total length 2865</td><td>29578</td><td>p006167001</td><td>2022-Q2</td></tr>
</tbody></table>
<p>Total 807 rows</p>
</div>
<div class="row">
<h2>5_project_country_quarter_amt</h2>
<h3>Script node 5_project_country_quarter_amt:</h3>
<pre id="json">{
  "5_project_country_quarter_amt": {
    "type": "table_custom_tfm_table",
    "custom_proc_type": "py_calc",
    "desc": "Get country quarter amount",
    "start_policy": "{manual_if_multi}",
    "r": {
      "table": "quarterly_project_bdgt_tggd_by_country_qtr",
      "expected_batches_total": "{get_amt_from_json_batches|number}"
    },
    "p": {
      "python_code_urls": [
        "{dir_py}/get_amt_from_json.py"
      ],
      "calculated_fields": {
        "amt": {
          "expression": "get_amt_by_key_and_quarter(r.country, r.quarter, r.country_budget_json)",
          "type": "float"
        }
      }
    },
    "w": {
      "name": "project_country_quarter_amt",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "country": {
          "expression": "r.country",
          "type": "string"
        },
        "quarter": {
          "expression": "r.quarter",
          "type": "string"
        },
        "amt": {
          "expression": "p.amt",
          "type": "float"
        }
      }
    }
  }
}</pre>
<h3>Script node 5_project_country_quarter_amt produces Cassandra table project_country_quarter_amt:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">amt</th><th class="text-right">batch_idx</th><th class="text-right">country</th><th class="text-right">project_id</th><th class="text-right">quarter</th></thead><tbody>
<tr><td>8352437364985377892</td><td>8979731.903485255316</td><td>5</td><td>R-MIDDLEEAST</td><td>p005247001</td><td>2022-Q1</td></tr>
<tr><td>1467471873947741681</td><td>1208803.240994196851</td><td>6</td><td>R-SOUTHAMERICA</td><td>m013705001</td><td>2019-Q3</td></tr>
<tr><td>1146470614011740801</td><td>1179775.280898876255</td><td>7</td><td>R-AFRICA</td><td>p008157001</td><td>2032-Q2</td></tr>
<tr><td>5947481005455973810</td><td>1192739.844425237738</td><td>9</td><td>R-AFRICA</td><td>p008157001</td><td>2034-Q3</td></tr>
<tr><td>7402402944726961228</td><td>1096605.744125326397</td><td>9</td><td>R-AMERICA</td><td>d002243001</td><td>2019-Q1</td></tr>
<tr><td>3123951200987607634</td><td>518932.481751824787</td><td>1</td><td>R-EUROPE</td><td>p010532001</td><td>2035-Q2</td></tr>
<tr><td>6067614188642658611</td><td>797109.383554144297</td><td>8</td><td>R-NORTHCENTRALAMERICA</td><td>m013705001</td><td>2026-Q2</td></tr>
<tr><td>3586706661276337928</td><td>8500451.26353790611</td><td>5</td><td>R-ASIA</td><td>m012761001</td><td>2010-Q2</td></tr>
<tr><td>3316991650243725571</td><td>805868.827329464606</td><td>6</td><td>R-NORTHCENTRALAMERICA</td><td>m013705001</td><td>2032-Q3</td></tr>
<tr><td>307696516709794065</td><td>2092641.261498028878</td><td>3</td><td>PH</td><td>p010807001</td><td>2029-Q2</td></tr>
</tbody></table>
<p>Total 2815 rows</p>
</div>
<div class="row">
<h2>5_project_sector_quarter_amt</h2>
<h3>Script node 5_project_sector_quarter_amt:</h3>
<pre id="json">{
  "5_project_sector_quarter_amt": {
    "type": "table_custom_tfm_table",
    "custom_proc_type": "py_calc",
    "desc": "Get sector quarter amount",
    "start_policy": "{manual_if_multi}",
    "r": {
      "table": "quarterly_project_bdgt_tggd_by_sector_qtr",
      "expected_batches_total": "{get_amt_from_json_batches|number}"
    },
    "p": {
      "python_code_urls": [
        "{dir_py}/get_amt_from_json.py"
      ],
      "calculated_fields": {
        "amt": {
          "expression": "get_amt_by_key_and_quarter(r.sector, r.quarter, r.sector_budget_json)",
          "type": "float"
        }
      }
    },
    "w": {
      "name": "project_sector_quarter_amt",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "sector": {
          "expression": "r.sector",
          "type": "int"
        },
        "quarter": {
          "expression": "r.quarter",
          "type": "string"
        },
        "amt": {
          "expression": "p.amt",
          "type": "float"
        }
      }
    }
  }
}</pre>
<h3>Script node 5_project_sector_quarter_amt produces Cassandra table project_sector_quarter_amt:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">amt</th><th class="text-right">batch_idx</th><th class="text-right">project_id</th><th class="text-right">quarter</th><th class="text-right">sector</th></thead><tbody>
<tr><td>1779323788083840704</td><td>9821920</td><td>1</td><td>d003827001</td><td>2019-Q4</td><td>12263</td></tr>
<tr><td>3242940668563944892</td><td>54605.887939221277</td><td>0</td><td>p012183001</td><td>2040-Q3</td><td>23630</td></tr>
<tr><td>3196811808504227128</td><td>249096.682360670093</td><td>7</td><td>m013705001</td><td>2025-Q2</td><td>23240</td></tr>
<tr><td>4134373396957659457</td><td>249096.682360670093</td><td>6</td><td>m013705001</td><td>2030-Q2</td><td>23270</td></tr>
<tr><td>4898646005207659992</td><td>562527.296549716149</td><td>2</td><td>p012801001</td><td>2033-Q4</td><td>31150</td></tr>
<tr><td>4655671061090342577</td><td>262317.518248175154</td><td>5</td><td>p010532001</td><td>2028-Q4</td><td>41010</td></tr>
<tr><td>7308084502650371569</td><td>251834.008540457668</td><td>5</td><td>m013705001</td><td>2036-Q3</td><td>41030</td></tr>
<tr><td>8863493122566626848</td><td>2219286.657859973609</td><td>2</td><td>p005253001</td><td>2025-Q1</td><td>13020</td></tr>
<tr><td>2051407001243747950</td><td>54605.887939221277</td><td>6</td><td>p012183001</td><td>2026-Q4</td><td>23270</td></tr>
<tr><td>4457792887679449827</td><td>251834.008540457668</td><td>8</td><td>m013705001</td><td>2034-Q4</td><td>14015</td></tr>
</tbody></table>
<p>Total 4100 rows</p>
</div>
<div class="row">
<h2>5_project_partner_quarter_amt</h2>
<h3>Script node 5_project_partner_quarter_amt:</h3>
<pre id="json">{
  "5_project_partner_quarter_amt": {
    "type": "table_custom_tfm_table",
    "custom_proc_type": "py_calc",
    "desc": "Get partner quarter amount",
    "start_policy": "{manual_if_multi}",
    "r": {
      "table": "quarterly_project_bdgt_tggd_by_partner_qtr",
      "expected_batches_total": "{get_amt_from_json_batches|number}"
    },
    "p": {
      "python_code_urls": [
        "{dir_py}/get_amt_from_json.py"
      ],
      "calculated_fields": {
        "amt": {
          "expression": "get_amt_by_quarter(r.quarter, r.partner_budget_json)",
          "type": "float"
        }
      }
    },
    "w": {
      "name": "project_partner_quarter_amt",
      "fields": {
        "project_id": {
          "expression": "r.project_id",
          "type": "string"
        },
        "partner_id": {
          "expression": "r.partner_id",
          "type": "int"
        },
        "quarter": {
          "expression": "r.quarter",
          "type": "string"
        },
        "amt": {
          "expression": "p.amt",
          "type": "float"
        }
      }
    }
  }
}</pre>
<h3>Script node 5_project_partner_quarter_amt produces Cassandra table project_country_quarter_amt:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">rowid</th><th class="text-right">amt</th><th class="text-right">batch_idx</th><th class="text-right">country</th><th class="text-right">project_id</th><th class="text-right">quarter</th></thead><tbody>
<tr><td>5728672404326026007</td><td>788436.268068331177</td><td>0</td><td>MK</td><td>p010807001</td><td>2045-Q1</td></tr>
<tr><td>8383636330285209887</td><td>4218954.724122870713</td><td>1</td><td>R-ASIA</td><td>p012801001</td><td>2041-Q4</td></tr>
<tr><td>4554746474091386522</td><td>2069645.203679369297</td><td>3</td><td>IN</td><td>p010807001</td><td>2027-Q1</td></tr>
<tr><td>3593219858001012360</td><td>524635.036496350309</td><td>8</td><td>R-EUROPE</td><td>p010532001</td><td>2041-Q4</td></tr>
<tr><td>2927563276626245485</td><td>2092641.261498028878</td><td>6</td><td>ZA</td><td>p010807001</td><td>2023-Q2</td></tr>
<tr><td>8515675698706982132</td><td>2092641.261498028878</td><td>4</td><td>IN</td><td>p010807001</td><td>2045-Q2</td></tr>
<tr><td>6853973419823718100</td><td>2115637.319316688459</td><td>5</td><td>PH</td><td>p010807001</td><td>2033-Q3</td></tr>
<tr><td>6898433930390248265</td><td>498193.364721340185</td><td>2</td><td>R-WESTINDIES</td><td>m013705001</td><td>2030-Q2</td></tr>
<tr><td>6898697046540229926</td><td>797196.671046868199</td><td>3</td><td>MK</td><td>p010807001</td><td>2036-Q1</td></tr>
<tr><td>1721444317230417779</td><td>894602.001906577731</td><td>3</td><td>R-AMERICA</td><td>p006167001</td><td>2031-Q2</td></tr>
</tbody></table>
<p>Total 2815 rows</p>
</div>
<div class="row">
<h2>6_file_project_country_quarter_amt</h2>
<h3>Script node 6_file_project_country_quarter_amt:</h3>
<pre id="json">{
  "6_file_project_country_quarter_amt": {
    "type": "table_file",
    "desc": "Write project_country_quarter_amt.csv",
    "r": {
      "table": "project_country_quarter_amt"
    },
    "w": {
      "top": {
        "order": "quarter,project_id,country"
      },
      "url_template": "{dir_out}/project_country_quarter_amt.csv",
      "columns": [
        {
          "csv": {
            "header": "project_id",
            "format": "%s"
          },
          "name": "project_id",
          "expression": "r.project_id",
          "type": "string"
        },
        {
          "csv": {
            "header": "country_code",
            "format": "%s"
          },
          "name": "country",
          "expression": "r.country",
          "type": "string"
        },
        {
          "csv": {
            "header": "quarter",
            "format": "%s"
          },
          "name": "quarter",
          "expression": "r.quarter",
          "type": "string"
        },
        {
          "csv": {
            "header": "amt",
            "format": "%.2f"
          },
          "name": "amt",
          "expression": "r.amt",
          "type": "float"
        }
      ]
    }
  }
}</pre>
<h3>Script node 6_file_project_country_quarter_amt produces data file:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">project_id</th><th class="text-right">country_code</th><th class="text-right">quarter</th><th class="text-right">amt</th></thead><tbody>
<tr><td>m012672001</td><td>R-AFRICA</td><td>2007-Q4</td><td>19856189.45</td></tr>
<tr><td>m012672001</td><td>R-AFRICA</td><td>2008-Q1</td><td>29621528.53</td></tr>
<tr><td>m012761001</td><td>R-AFRICA</td><td>2008-Q1</td><td>3326263.54</td></tr>
<tr><td>m012761001</td><td>R-AMERICA</td><td>2008-Q1</td><td>369584.84</td></tr>
<tr><td>m012761001</td><td>R-ASIA</td><td>2008-Q1</td><td>1214350.18</td></tr>
<tr><td>m012761001</td><td>R-EUROPE</td><td>2008-Q1</td><td>369584.84</td></tr>
<tr><td>m012672001</td><td>R-AFRICA</td><td>2008-Q2</td><td>29621528.53</td></tr>
<tr><td>m012761001</td><td>R-AFRICA</td><td>2008-Q2</td><td>23283844.77</td></tr>
<tr><td>m012761001</td><td>R-AMERICA</td><td>2008-Q2</td><td>2587093.86</td></tr>
<tr><td>m012761001</td><td>R-ASIA</td><td>2008-Q2</td><td>8500451.26</td></tr>
</tbody></table>
<p>Total 2815 rows</p>
</div>
<div class="row">
<h2>6_file_project_sector_quarter_amt</h2>
<h3>Script node 6_file_project_sector_quarter_amt:</h3>
<pre id="json">{
  "6_file_project_sector_quarter_amt": {
    "type": "table_file",
    "desc": "Write project_sector_quarter_amt.csv",
    "r": {
      "table": "project_sector_quarter_amt"
    },
    "w": {
      "top": {
        "order": "quarter,project_id,sector"
      },
      "url_template": "{dir_out}/project_sector_quarter_amt.csv",
      "columns": [
        {
          "csv": {
            "header": "project_id",
            "format": "%s"
          },
          "name": "project_id",
          "expression": "r.project_id",
          "type": "string"
        },
        {
          "csv": {
            "header": "sector_id",
            "format": "%d"
          },
          "name": "sector",
          "expression": "r.sector",
          "type": "int"
        },
        {
          "csv": {
            "header": "quarter",
            "format": "%s"
          },
          "name": "quarter",
          "expression": "r.quarter",
          "type": "string"
        },
        {
          "csv": {
            "header": "amt",
            "format": "%.2f"
          },
          "name": "amt",
          "expression": "r.amt",
          "type": "float"
        }
      ]
    }
  }
}</pre>
<h3>Script node 6_file_project_sector_quarter_amt produces data file:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">project_id</th><th class="text-right">sector_id</th><th class="text-right">quarter</th><th class="text-right">amt</th></thead><tbody>
<tr><td>m012672001</td><td>11420</td><td>2007-Q4</td><td>1389933.26</td></tr>
<tr><td>m012672001</td><td>14021</td><td>2007-Q4</td><td>1985618.95</td></tr>
<tr><td>m012672001</td><td>14022</td><td>2007-Q4</td><td>1985618.95</td></tr>
<tr><td>m012672001</td><td>15110</td><td>2007-Q4</td><td>3971237.89</td></tr>
<tr><td>m012672001</td><td>21020</td><td>2007-Q4</td><td>3971237.89</td></tr>
<tr><td>m012672001</td><td>23630</td><td>2007-Q4</td><td>3971237.89</td></tr>
<tr><td>m012672001</td><td>31120</td><td>2007-Q4</td><td>2581304.63</td></tr>
<tr><td>m012672001</td><td>11420</td><td>2008-Q1</td><td>2073507.00</td></tr>
<tr><td>m012672001</td><td>14021</td><td>2008-Q1</td><td>2962152.85</td></tr>
<tr><td>m012672001</td><td>14022</td><td>2008-Q1</td><td>2962152.85</td></tr>
</tbody></table>
<p>Total 4100 rows</p>
</div>
<div class="row">
<h2>6_file_project_partner_quarter_amt</h2>
<h3>Script node 6_file_project_partner_quarter_amt:</h3>
<pre id="json">{
  "6_file_project_partner_quarter_amt": {
    "type": "table_file",
    "desc": "Write project_partner_quarter_amt.csv",
    "r": {
      "table": "project_partner_quarter_amt"
    },
    "w": {
      "top": {
        "order": "quarter,project_id,partner_id"
      },
      "url_template": "{dir_out}/project_partner_quarter_amt.csv",
      "columns": [
        {
          "csv": {
            "header": "project_id",
            "format": "%s"
          },
          "name": "project_id",
          "expression": "r.project_id",
          "type": "string"
        },
        {
          "csv": {
            "header": "partner_id",
            "format": "%d"
          },
          "name": "partner_id",
          "expression": "r.partner_id",
          "type": "int"
        },
        {
          "csv": {
            "header": "quarter",
            "format": "%s"
          },
          "name": "quarter",
          "expression": "r.quarter",
          "type": "string"
        },
        {
          "csv": {
            "header": "amt",
            "format": "%.2f"
          },
          "name": "amt",
          "expression": "r.amt",
          "type": "float"
        }
      ]
    }
  }
}</pre>
<h3>Script node 6_file_project_partner_quarter_amt produces data file:</h3>
<table class="table table-striped text-right" style="font-size:smaller">
<thead><th class="text-right">project_id</th><th class="text-right">partner_id</th><th class="text-right">quarter</th><th class="text-right">amt</th></thead><tbody>
<tr><td>m012672001</td><td>29663</td><td>2007-Q4</td><td>19856189.45</td></tr>
<tr><td>m012672001</td><td>29663</td><td>2008-Q1</td><td>29621528.53</td></tr>
<tr><td>m012761001</td><td>29979</td><td>2008-Q1</td><td>5279783.39</td></tr>
<tr><td>m012672001</td><td>29663</td><td>2008-Q2</td><td>29621528.53</td></tr>
<tr><td>m012761001</td><td>29979</td><td>2008-Q2</td><td>36958483.75</td></tr>
<tr><td>m012672001</td><td>29663</td><td>2008-Q3</td><td>29947039.83</td></tr>
<tr><td>m012761001</td><td>29979</td><td>2008-Q3</td><td>37364620.94</td></tr>
<tr><td>m012672001</td><td>29663</td><td>2008-Q4</td><td>29947039.83</td></tr>
<tr><td>m012761001</td><td>29979</td><td>2008-Q4</td><td>37364620.94</td></tr>
<tr><td>m012672001</td><td>29663</td><td>2009-Q1</td><td>29296017.22</td></tr>
</tbody></table>
<p>Total 807 rows</p>
</div>
</div></body></head>
